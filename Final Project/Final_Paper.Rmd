---
title: "How Different Type of Behavior Would Alleviate or Excerbate Students Depression"
author: "Shijie An"
date: "2022-11-22"
output: pdf_document
---
```{r warning = FALSE}
library(tidyverse)
library(ggplot2)
library(ggpubr)
library(caret)
```
# Literature Review
Depression is the number one mental health concern among college students, but there is a lack of research exploring how online college science courses may exacerbate or lesson their depression. In the paper, there are 41 variables, which only 1 of them is continuous variable, which is GPA, and other 40 of those variables are categorical variables, which contains whether students are depression, how severity are their depression is, what are the cases that they have to face that will alleviate or exacerbate their depression, are there STEM majors or not, what division/gender are they, are they the first generation college students/LGBTQ, what are their financial status, are they going to keep depression, and what aspect of online course would affect students' depression.

## Current Study

Some researches have already described that students would alleviate or exacerbate their depreesion due to some cases that they have experienced in online class. But different students with different background would behave different symptoms, whether they would keep depressed or they will no longer depressed. We cannot tell if their background such as race or ethnicity or gender would affect their opinions to let them depressed. To address these differences, we would have some questions that need to investigate to find out the solution for students that take online classes. 

1. Is GPA/Race/Gender/LQBTQ/College Generation Status/Financial Status/STEM major/Year in College a greatest factor that affect students' depression? 
2. Which kind of students would tend to be depressed? 
3. What scenario would alleviate students' depression? 
4. What scenario would exacerbate students' depression? 



# Methods and Sample

## Samples
First, in the data set, since it seems that students who have no depression or refuses to answer the questions all seem to have no experiences from cases of depression, we would like to change the variable of `depression` to answers only contains "yes" and "no". 
```{r, warning = FALSE}
dep <- read.csv("pone.0269201.s002.csv")
dep$depression <- ifelse(dep$depression == "yes", "yes", "no")
dep <- dep %>% mutate(GPA = as.numeric(GPA))
```

Since there are many missing values because there are some students who don't have depression or refuse to answer the question, for cases that that students may experiences, I would like to put the missing value NA to -1 so the data set contains 1, 0, -1. And for other categorical data, I would like to put the missing value NA to "unknown". 
```{r}
missingCol <- grep("idep|ddep", colnames(dep))
dep[, missingCol][is.na(dep[, missingCol])] <- -1
dep[, -missingCol][is.na(dep[, -missingCol])] <- "Unknown"
```

The general information is also required, because the generation information can help to analyze the distribution for students. 
```{r eval = FALSE}
for(i in 34:41) {
  print(stat(table(dep[i])))
  print(prop.table(stat(table(dep[i]))))
}
```

The students' general information showed that almost two-third of the students in this query are women (66.94%), most of these students are continuing-generation students (58.76%), and most of them are STEM majors (55.78%). The following form represents a statistical student information.  

![Student Information](D:\CU TC\hudm 5026 intro to R\HUDM5026_R_HW\Final Project\Student Information.png)

## Methods
To answer the research questions, the data set gives bunch of information of undergraduates enrolled in an in-person degree program who were completing science courses online in summer 2020, fall 2020, and spring 2021. This data set is given to let researchers understand how online science courses would alleviate or exacerbate students' depression symptoms. 

### QR:1. Is GPA/Race/Gender/LQBTQ/College Generation Status/Financial Status/STEM major/Year in College a greatest factor that affect students' depression? 
To answer up what is the greatest factor that affect students' depression, the best way is to visualize them. 
For GPA, the best way to visualize GPA is to use boxplot and separate it with students who are depressed and students who are not. Boxplots are used to show distributions of numeric data values, especially when we want to compare them to multiple groups. The boxplot will provide information such as the 25% quantile, the median, the 75% quantile, the upper fence and lower fence. 


### QR:2. Which kind of students would tend to be depressed? 
### QR:3. What scenario would alleviate students' depression? 
### QR:4. What scenario would exacerbate students' depression? 



# Findings

### Finding:1. LGBTQ groups is the greatest factor that affect students' depression, gender identitiy is the second greatest factor that affect students' depression. 
```{r plots, warning = FALSE, echo = FALSE}
count_race <- dep %>% ggplot(aes(x = race2, fill = depression)) + 
  geom_bar(alpha = 0.3)
perc_race <- dep %>% ggplot(aes(x = race2, fill = depression)) + 
  geom_bar(alpha = 0.3, position = "fill")
count_gender <- dep %>% ggplot(aes(x = gender2, fill = depression)) + 
  geom_bar(alpha = 0.3)
perc_gender <- dep %>% ggplot(aes(x = gender2, fill = depression)) + 
  geom_bar(alpha = 0.3, position = "fill")
count_lgbtq <- dep %>% ggplot(aes(x = lgbtq2, fill = depression)) + 
  geom_bar(alpha = 0.3)
perc_lgbtq <- dep %>% ggplot(aes(x = lgbtq2, fill = depression)) + 
  geom_bar(alpha = 0.3, position = "fill")
gpa <- dep %>% 
  ggplot(aes(x = depression, y = as.numeric(GPA))) + 
  geom_boxplot()
ggarrange(count_race, perc_race, count_gender, perc_gender, count_lgbtq,
          perc_lgbtq, gpa, ncol = 2, nrow = 4)

```
For GPA, it shows that students who are in depression seem to have a lower GPA than students who don't have a depression, but the different is very small so it can't tell if GPA is one of the greatest factor. 

Based on the graph of different categorical variable, it shows that the asian student seems to have less depression than other races (57.94%), students who have confusion about their gender identities seem to be easier in depression (73.08%), and students who are LGBTQ groups tend to be easier in depression (79.78%). 

The graph shows the race/gender/lgbtq statistical differences and percentage differences. 


### Finding:2. The students who are white, who are women, who is in LGBTQ group seem to have significant statistical value to prove they will be depressed. 
```{r eval = FALSE}
set.seed(1234)
regression <- dep %>% select(depression, race2, division, gender2, 
                             gen.stat2, lgbtq2, financially.stable2)
logistic <- train(depression ~ ., data = regression, method = "glm", 
                  preProcess = c("scale", "center"), 
                  family = binomial(link = "logit"))
summary(logistic)
```
Based on the logistic regression that we selected from gender, race, division, generation, lgbtq, financial status, it can be seen that the white students (2.46e-06), women students (5.29e-08), lgbtq students (2e-16) have a significant value which their p-value are all in between 0 and 0.001, which shows being depression is strongly related to these circumstances. 

### Finding:3. What scenario would alleviate students' depression? 
```{r eval = FALSE}
dep_no <- dep %>% filter(depression2 == "yes") %>% select(contains("ddep"))
namelist <- colnames(dep_no)
for(i in namelist) {
  print(table(dep_no[i]))
  print(prop.table(table(dep_no[i])))
  print("-----------------------------------")
}

```

 ![alleviate](D:\CU TC\hudm 5026 intro to R\HUDM5026_R_HW\Final Project\alleviate.png)

 

### Finding:4. What scenario would exacerbate students' depression? 
```{r eval = FALSE}
dep_yes <- dep %>% filter(depression2 == "yes") %>% select(contains("idep"))
namelist <- colnames(dep_yes)
for(i in namelist) {
  print(table(dep_yes[i]))
  print(prop.table(table(dep_yes[i])))
  print("-----------------------------------")
}

```

![exacerbate](D:\CU TC\hudm 5026 intro to R\HUDM5026_R_HW\Final Project\exacerbate.png)



# Discussion







